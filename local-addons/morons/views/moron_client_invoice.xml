<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Tree view: Client invoice -->
    <record id="client_invoice_view_tree" model="ir.ui.view">
        <field name="name">client_invoice.tree</field>
        <field name="model">account.move</field>
        <field name="priority">80</field>
        <field name="arch" type="xml">
            <tree>
                <field name="currency_id" invisible="1"/>
                <field name="company_currency_id" invisible="1"/>
                <field name="name"/>
                <field name="invoice_partner_display_name"/>
                <field name="invoice_date" />
                <field name="invoice_date_due" />
                <field name="sale_order_ids" widget="many2many_tags" string="Sale Orders"/>
                <field name="amount_total_signed" sum="Total" decoration-bf="1"/>
                <field name="paid_on" />
                <field name="payment_state" widget="badge"
                    decoration-danger="payment_state == 'not_paid'"
                    decoration-warning="payment_state in ('partial', 'in_payment')"
                    decoration-success="payment_state in ('paid', 'reversed')"
                    attrs="{'invisible': [('payment_state', 'in', ('invoicing_legacy'))]}"
                />
                <field name="state" widget="badge"
                    decoration-success="state == 'posted'"
                    decoration-info="state == 'draft'"
                />
                <field name="move_type" invisible="1"/>
            </tree>
        </field>
    </record>

    <!-- Form view: Client invoice -->
    <record id="client_invoice_view_form_all" model="ir.ui.view">
        <field name="name">client_invoice.form</field>
        <field name="model">account.move</field>
        <field name="priority">80</field>
        <field name="inherit_id" ref="account.view_move_form"/>
        <field name="mode">primary</field>
        <field name="arch" type="xml">

            <xpath expr="//button[@name='button_set_checked']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//button[@name='action_reverse']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
        
            <field name="partner_id" position="after">
                <field name="sale_order_ids" widget="many2many_tags" string="Sale Orders" readonly="1"/>
                <field name="paid_on" attrs="{'readonly': [('payment_state', '!=', 'paid')]}" />
            </field>
            <xpath expr="//field[@name='invoice_line_ids']/tree/field[@name='product_id']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>

            <xpath expr="//label[@for='journal_id']" position="before">
                <field name="invoice_date_due" attrs="{'invisible': [('invoice_payment_term_id', '=', False)], 'readonly': [('state', '!=', 'draft')]}" />
            </xpath>

            <field name="payment_reference" position="attributes">
                <attribute name="invisible">1</attribute>
            </field>
        </field>
    </record>

    <!-- Action: Client Invoices -->
    <record id="client_invoice_action_all" model="ir.actions.act_window">
        <field name="name">Client Invoices</field>
        <field name="res_model">account.move</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('move_type', '=', 'out_invoice'), ('is_client_invoice', '=', True)]</field>
        <field name="context">{'default_move_type': 'out_invoice'}</field>
    </record>

    <record id="client_invoice_action_view_tree_all" model="ir.actions.act_window.view">
        <field name="sequence" eval="1"/>
        <field name="view_mode">tree</field>
        <field name="view_id" ref="client_invoice_view_tree"/>
        <field name="act_window_id" ref="client_invoice_action_all"/>
    </record>

    <record id="client_invoice_action_view_form_all" model="ir.actions.act_window.view">
        <field name="sequence" eval="1"/>
        <field name="view_mode">form</field>
        <field name="view_id" ref="client_invoice_view_form_all"/>
        <field name="act_window_id" ref="client_invoice_action_all"/>
    </record>

</odoo>